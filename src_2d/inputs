# SIMULATION LENGTH
length.max_step  = 2000	             # Maximum number of time-steps
length.stop_time = 0.7               # Maximum simulated time [s]
length.dt = 0.00001  			     # Timestep (changed automatically by the code if it does not satisfy the stability criteria)

# MESH GENERATION (SOME PARAMETERS ARE NOT USED BUT NECESSARY FOR AMREX)
geometry.is_periodic  =  0 0	         		# Set to 0 because the system is not periodic (x,y)
geometry.coord_sys    =  0               		# Set to 0 because cartesian coordinates are used
geometry.prob_lo      =  0.00  0.00      		# Coordinates of the bottom-left corner of the domain (x,y)
geometry.prob_hi      =  0.04  0.012     		# Coordinates of the top-right corner of the domain (x,y)
amr.n_cell            =  128 512		 		# Number of cells (x,y)
amr.max_level         =  0               		# Maximum level (The smallest level is at 0)
amr.ref_ratio         =  4 4               		# Grid refinement ratio between successive levels (0-->1, 1-->2, ...) 
amr.blocking_factor   =  8             			# Minimum number of cells per grid in each direction
amr.max_grid_size     =  16 	         		# Maximum number of cells per grid in each direction
amr.v                 =  1               		# Verbosity in amrex (1 = on, 0 = off)
grid.regrid_int       =  1               		# How often to check if regridding is necessary (in time-step)
grid.max_grid_size_1d =  16	             		# Maximum number of cells per grid in each direction (for shallow-water solver)
grid.surfdist 		  =  0.004 0.003			# Distance from the free surface that triggers regridding (one value per level)

# HEAT SOLVER
heat.fixed_melt_velocity = 0.0			 			# Prescribed melt velocity
heat.solve = 1										# Flag to control if the temperature equation is to be solved. If it is off then the melt pool is initiliazed to a gaussian shape with center at 2cm, peak depth 200um, and width 5mm
heat.temp_init = 2900			     	 			# Initial temperature of the sample
heat.phase_init = solid			     	 			# Initial phase of the sample (solid or liquid, relevant only if the sample is initialized at the melting temperature)
heat.surf_pos = 0.010                            	# Position of the free surface inside the domain (assumed horizontal and perpendicular to the y-direction)
heat.plasma_flux_type = Gaussian		 	 		# Type of plasma heat flux
heat.plasma_flux_params = 0.0 0.003 1e9 0.02 0.0099 # Parameters for the plasma heat flux (dependent on the type of heat flux selected)
heat.temp_free_surface = -3300	             	 	# Fixed temperature at the free surface (only used if positive)
heat.cooling_thermionic = 1		     	 			# Activate or deactivate thermionic cooling flux (1 = on, 0 = off)
heat.cooling_vaporization = 1		     	 		# Activate or deactivate vaporization cooling flux (1 = on, 0 = off)
heat.cooling_radiation = 1		     	 			# Activate or deactivate radiative cooling flux (1 = on, 0 = off)
heat.cooling_debug = 1 2000 4000 2000 1e9	 		# Plot cooling fluxes as a function of temperature (on/off switch, 1 = on, 0 = off,
		                                 			# minimum temperature, min_T
						 							# maximum temperature, max_T
						 							# number of points between min_T and max_T
						 							# plasma flux for the thermionic cooling)
heat.thermionic_alpha = 90        	 	 			# Magnetic inclination [deg]
heat.heat_solver = implicit

# SHALLOW WATER SOLVER
sw.solve = 0              	# Flag to control if the melt motion is on (1 = on, 0 = off)
sw.solve_momentum = 0 		# Flag to control if the momentum equation in the SW equations is solved (1 = on, 0 = off)
sw.drytol = 3e-6    		# Minimum melt-layer thickness to compute the source terms
sw.jxb = 8.0e6 	    		# jxb force (x,z)
sw.magnetic = 2.5 	    	# B field [T]
sw.h_cap = 12e-5					# The capping value for the friction term in the momentum equation [m]

# MATERIAL
material.material = Tungsten                 # Material
material.phiT_max_T = 8000                   # Maximum temperature used to generate the enthalpy-temperature tables
material.phiT_n_points = 10000	             # Number of points used to generature the enthalpy-temperature tables

# OUTPUT
output.plot_file  = plt                 # Name of the plot files to open in amrex
output.plot_int   = 10000 	             	# How often to produce a plot file (in time-steps)    
output.check_file = chk		            # Name of the restart files
output.check_int = 25		            # How often to produce a restart file (in time-steps)
output.verbose   = 1		            # Verbosity of the code (1 = on, 0 = off)

# NUMERICS
numerics.cfl       = 0.95	             # Safety factor used to multiply the minimum time-step which ensures stability of the heat solver
numerics.do_reflux = 1		             # Activate or deactivate reflux ( 1 = on, 0 = off)
numerics.dt_change_max = 1.1 	         # Maximum fractional change of the time step between two successive time-steps

# LINEAR SOLVERS
linear_solver.composite_solve = 1
linear_solver.verbose = 0
linear_solver.bottom_verbose_ls = 0
linear_solver.max_iter = 200
linear_solver.max_fmg_iter = 0
linear_solver.bottom_solver = 1
linear_solver.linop_maxorder = 2
linear_solver.agglomeration = 1
linear_solver.consolidation = 1
linear_solver.max_coarsening_level = 30
linear_solver.dt = 0.001